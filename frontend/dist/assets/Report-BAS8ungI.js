import{_ as L}from"./none-CwC0Lq_I.js";import{c as q}from"./chart-Bt2xmhMA.js";import{R as M}from"./Result-DvMrgyyD.js";import{t as P}from"./dateTools-APCdG_Ih.js";import{u as j,h as I}from"./index-Bqsb1G-Q.js";import{v as G,e as C,o as H,aF as J,a0 as K,L as m,P as h,M as l,ao as c,E as r,U as a,F as p,R as n,S as u,u as O,D as d,T as S,a8 as D}from"./vue-CXALzJrr.js";import{_ as Q}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./Editor-CMLAlzEc.js";import"./ProStore-981bTmq_.js";const W="/assets/report-pvANfxU2.png",X={style:{"margin-left":"20px"}},Y={style:{"margin-left":"20px"}},Z={key:0,class:"title",style:{color:"#1ab43a"}},ee={key:1,class:"title",style:{color:"#f8bb08"}},te={key:2,class:"title",style:{color:"#f6051e"}},le={key:0,style:{color:"#1ab43a"}},ae={key:1,style:{color:"#f8bb08"}},re={key:2,style:{color:"#f6051e"}},se={key:1,class:"table-empty",style:{"text-align":"center",padding:"200px 0"}},ne={__name:"Report",setup(oe){const R=j(),V=J(),t=G({record:null,report:null,showScentDatas:[]});async function A(o){const e=await I.reportApi.getReport(o);e.status===200&&(t.report=e.data.info,t.showScentDatas=t.report.results)}async function F(o){const e=await I.recordApi.getRecordInfo(o);e.status===200&&(t.record=e.data)}function T(){const o=[t.report.all,t.report.success,t.report.fail,t.report.error],e=["用例总数","通过用例","失败用例","错误用例"],i=document.querySelector("#chart1");q.chart1(i,o,e,R.value)}function U(){const o=[{value:t.report.success,name:"通过"},{value:t.report.fail,name:"失败"},{value:t.report.error,name:"错误"}],e=document.querySelector("#chart2");q.chart2(e,o,R.value)}const y=C(()=>t.report.results.filter(function(o,e,i){return o.state==="success"})),v=C(()=>t.report.results.filter(function(o,e,i){return o.state==="fail"})),g=C(()=>t.report.results.filter(function(o,e,i){return o.state==="error"}));return H(()=>{const o=V.params.id;A(o),F(o)}),K(()=>{document.querySelector("#chart1")&&T(),document.querySelector("#chart2")&&U()}),(o,e)=>{const i=c("el-descriptions-item"),$=c("el-tag"),z=c("el-descriptions"),b=c("el-card"),w=c("el-col"),B=c("el-row"),f=c("el-button"),N=c("el-scrollbar"),_=c("el-table-column"),E=c("el-table");return t.report?(r(),m(B,{key:0},{default:l(()=>[a(w,{span:12},{default:l(()=>[a(N,null,{default:l(()=>[t.record?(r(),m(b,{key:0},{default:l(()=>[e[9]||(e[9]=p("div",{class:"report_title"},[p("img",{src:W,alt:"plan",width:"20"}),n(" 接口自动化测试报告 ")],-1)),a(z,{column:6,title:"执行信息",direction:"vertical"},{default:l(()=>[a(i,{label:"计划名称",align:"center"},{default:l(()=>[n(u(t.record.plan),1)]),_:1}),a(i,{label:"环境名称",align:"center"},{default:l(()=>[n(u(t.record.env),1)]),_:1}),a(i,{label:"套件通过率",align:"center"},{default:l(()=>[n(u(t.record.pass_rate+"%"),1)]),_:1}),a(i,{label:"执行人",align:"center"},{default:l(()=>[n(u(t.record.tester),1)]),_:1}),a(i,{label:"执行状态",align:"center"},{default:l(()=>[t.record.status==="执行完毕"?(r(),m($,{key:0,type:"success"},{default:l(()=>[...e[7]||(e[7]=[n("执行完毕",-1)])]),_:1})):t.record.status==="执行中"?(r(),m($,{key:1,type:"info"},{default:l(()=>[...e[8]||(e[8]=[n("执行中",-1)])]),_:1})):h("",!0)]),_:1}),a(i,{label:"执行时间",align:"center"},{default:l(()=>[n(u(O(P).rTime(t.record.create_time)),1)]),_:1})]),_:1})]),_:1})):h("",!0),a(b,{"body-style":"padding:5px"},{default:l(()=>[e[12]||(e[12]=p("div",{class:"title",style:{padding:"15px"}}," 图表信息 ",-1)),a(B,{gutter:5},{default:l(()=>[a(w,{span:14},{default:l(()=>[...e[10]||(e[10]=[p("div",{class:"chartBox",id:"chart1"},null,-1)])]),_:1}),a(w,{span:10},{default:l(()=>[...e[11]||(e[11]=[p("div",{class:"chartBox",id:"chart2"},null,-1)])]),_:1})]),_:1})]),_:1}),t.report?(r(),m(b,{key:1},{default:l(()=>[a(z,{column:4,title:"套件统计",direction:"vertical"},{default:l(()=>[a(i,{label:"测试套件总数",align:"center"},{default:l(()=>[n(u(t.report.results.length),1)]),_:1}),a(i,{label:"通过测试套件",align:"center"},{default:l(()=>[n(u(y.value.length),1)]),_:1}),a(i,{label:"失败测试套件",align:"center"},{default:l(()=>[n(u(v.value.length),1)]),_:1}),a(i,{label:"错误测试套件",align:"center"},{default:l(()=>[n(u(g.value.length),1)]),_:1})]),_:1}),e[13]||(e[13]=p("p",{style:{"line-height":"30px"}},"未通过测试套件",-1)),p("div",X,[(r(!0),d(S,null,D(g.value,s=>(r(),m(f,{plain:"",size:"small",onClick:e[0]||(e[0]=x=>t.showScentDatas=g.value),type:"danger",key:s.name},{default:l(()=>[n(u(s.name),1)]),_:2},1024))),128)),(r(!0),d(S,null,D(v.value,s=>(r(),m(f,{plain:"",size:"small",onClick:e[1]||(e[1]=x=>t.showScentDatas=v.value),type:"warning",key:s.name},{default:l(()=>[n(u(s.name),1)]),_:2},1024))),128))]),e[14]||(e[14]=p("p",{style:{"line-height":"30px"}},"已通过测试套件",-1)),p("div",Y,[(r(!0),d(S,null,D(y.value,s=>(r(),m(f,{plain:"",size:"small",onClick:e[2]||(e[2]=x=>t.showScentDatas=y.value),type:"success",key:s.name},{default:l(()=>[n(u(s.name),1)]),_:2},1024))),128))])]),_:1})):h("",!0)]),_:1})]),_:1}),a(w,{span:12},{default:l(()=>[p("div",null,[a(b,null,{default:l(()=>[a(f,{size:"small",type:"primary",plain:"",onClick:e[3]||(e[3]=s=>t.showScentDatas=t.report.results)},{default:l(()=>[...e[15]||(e[15]=[n(" 所有套件 ",-1)])]),_:1}),a(f,{size:"small",type:"success",plain:"",onClick:e[4]||(e[4]=s=>t.showScentDatas=y.value)},{default:l(()=>[...e[16]||(e[16]=[n("成功套件",-1)])]),_:1}),a(f,{size:"small",type:"warning",plain:"",onClick:e[5]||(e[5]=s=>t.showScentDatas=v.value)},{default:l(()=>[...e[17]||(e[17]=[n("失败套件",-1)])]),_:1}),a(f,{size:"small",type:"danger",plain:"",onClick:e[6]||(e[6]=s=>t.showScentDatas=g.value)},{default:l(()=>[...e[18]||(e[18]=[n("错误套件",-1)])]),_:1}),a(N,{height:"calc(100vh - 197px)"},{default:l(()=>[t.showScentDatas&&t.showScentDatas.length>0?(r(!0),d(S,{key:0},D(t.showScentDatas,(s,x)=>(r(),d("div",{class:"right_box",key:x,style:{"margin-top":"10px"}},[s.state==="success"?(r(),d("div",Z,u("测试套件 : "+s.name+"【通过】"),1)):s.state==="fail"?(r(),d("div",ee,u("测试套件 : "+s.name+"【失败】"),1)):(r(),d("div",te,u("测试套件 : "+s.name+"【错误】"),1)),a(E,{data:s.cases,style:{width:"100%","margin-top":"10px"},class:"result","show-header":!1,stripe:""},{default:l(()=>[a(_,{type:"expand"},{default:l(k=>[a(M,{result:k.row,hideBtn:!0},null,8,["result"])]),_:1}),a(_,{label:"序号",type:"index",width:"80px"}),a(_,{"show-overflow-tooltip":!0,label:"用例名称",prop:"name","min-width":"100px"}),a(_,{label:"请求方法",prop:"method","min-width":"40px"}),a(_,{label:"状态码",prop:"status_code","min-width":"40px"}),a(_,{label:"耗时",prop:"run_time","min-width":"40px"}),a(_,{label:"断言结果",prop:"state","min-width":"40px"},{default:l(k=>[k.row.state==="成功"?(r(),d("span",le,"成功")):k.row.state==="失败"?(r(),d("span",ae,"失败")):(r(),d("span",re,"错误"))]),_:1})]),_:1},8,["data"])]))),128)):(r(),d("div",se,[...e[19]||(e[19]=[p("img",{src:L,alt:"notData"},null,-1),p("div",null,"暂无数据",-1)])]))]),_:1})]),_:1})])]),_:1})]),_:1})):h("",!0)}}},ve=Q(ne,[["__scopeId","data-v-e561264e"]]);export{ve as default};
