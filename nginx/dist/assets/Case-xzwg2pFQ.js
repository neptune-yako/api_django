import{_ as S,C as j,a as J}from"./CaseEditor-NYfNa4js.js";import{P as M}from"./ProStore-981bTmq_.js";import{U as W,h as K,E as D}from"./index-Bqsb1G-Q.js";import{a as b,v as U,D as p,F as n,U as o,M as l,u as a,q as z,T as g,ao as i,aE as Q,E as s,R as u,a8 as w,L as f,S as k,P as X}from"./vue-CXALzJrr.js";import{_ as Y}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./FormData-CJACffRn.js";import"./none-CwC0Lq_I.js";import"./dateTools-APCdG_Ih.js";import"./Editor-CMLAlzEc.js";import"./Result-DvMrgyyD.js";const Z="/assets/add-DWJASPIz.png",h={class:"main_box"},ee={class:"card left_box"},te={class:"title_box"},le={key:5,style:{margin:"0 5px"}},oe={key:6},se={key:0,style:{margin:"0 5px"}},ae={key:1,style:{margin:"0 5px"}},ne={class:"card right_box"},ie={style:{"text-align":"center"}},re={__name:"Case",setup(de){const A=Q(),v=M(),R=W();let C=b();function V(_){C.value=_}let r=b(!1),d=U({title:"",interface:null,username:R.userInfo.username});function L(_){r.value=!0,d.interface=_}const I=U({title:[{required:!0,message:"用例名称不能为空！",trigger:"blur"}]}),E=b();async function N(_){_.validate(async function(e){if(!e)return;const m=await K.caseApi.createCase(d);m.status===201?(D({title:"测试用例添加成功！",type:"success",duration:1500}),await v.getAllInterFaceList(),V(m.data.id),r.value=!1):D({title:"测试用例添加失败！",message:m.data.detail,type:"error",duration:1500})})}return(_,e)=>{const m=i("el-button"),$=i("el-tooltip"),y=i("el-tag"),T=i("el-menu-item"),B=i("el-sub-menu"),F=i("el-menu"),P=i("el-input"),x=i("el-form-item"),q=i("el-option"),G=i("el-select"),H=i("el-form"),O=i("el-drawer");return s(),p(g,null,[n("div",h,[n("div",ee,[n("div",te,[e[8]||(e[8]=n("img",{src:S,width:"25",alt:""},null,-1)),e[9]||(e[9]=n("div",{class:"name"},"接口用例",-1)),o(m,{plain:"",onClick:a(v).getAllInterFaceList,type:"success",icon:"Refresh",size:"small"},{default:l(()=>[...e[7]||(e[7]=[u("刷新",-1)])]),_:1},8,["onClick"])]),o($,{class:"box-item",effect:"dark",content:"跳转到接口管理菜单",placement:"bottom"},{default:l(()=>[o(m,{onClick:e[0]||(e[0]=t=>a(A).push({name:"interface"})),type:"primary",plain:"",style:{width:"100%","margin-top":"5px"}},{default:l(()=>[...e[10]||(e[10]=[u(" 接口管理 ",-1)])]),_:1})]),_:1}),o(F,{"default-active":a(C),style:{"--el-menu-active-color":"#1471ea"}},{default:l(()=>[(s(!0),p(g,null,w(a(v).interfaces,t=>(s(),f(B,{index:t.id.toString(),key:t.id},{title:l(()=>[e[16]||(e[16]=n("img",{src:J,width:"20",alt:""},null,-1)),t.method==="GET"?(s(),f(y,{key:0,size:"small",type:"info"},{default:l(()=>[...e[11]||(e[11]=[u("GET",-1)])]),_:1})):t.method==="POST"?(s(),f(y,{key:1,size:"small",type:"success"},{default:l(()=>[...e[12]||(e[12]=[u("POST",-1)])]),_:1})):t.method==="PATCH"?(s(),f(y,{key:2,size:"small",type:"warning"},{default:l(()=>[...e[13]||(e[13]=[u("PATCH",-1)])]),_:1})):t.method==="PUT"?(s(),f(y,{key:3,size:"small",type:"primary"},{default:l(()=>[...e[14]||(e[14]=[u("PUT",-1)])]),_:1})):t.method==="DELETE"?(s(),f(y,{key:4,size:"small",type:"danger"},{default:l(()=>[...e[15]||(e[15]=[u("DELETE",-1)])]),_:1})):X("",!0),t.name.length<12?(s(),p("span",le,k(t.name),1)):(s(),p("span",oe,k(t.name.slice(0,12))+"...",1))]),default:l(()=>[(s(!0),p(g,null,w(t.cases,c=>(s(),f(T,{onClick:ue=>V(c.id),index:c.id+"",key:"_case.id"},{default:l(()=>[e[17]||(e[17]=n("img",{src:S,width:"20",alt:""},null,-1)),c.title.length<15?(s(),p("span",se,k(c.title),1)):(s(),p("span",ae,k(c.title.slice(0,15))+"...",1))]),_:2},1032,["onClick","index"]))),128)),o(T,{onClick:c=>L(t.id),index:t.id+"add"},{default:l(()=>[...e[18]||(e[18]=[n("img",{src:Z,width:"20",alt:""},null,-1),n("span",{style:{margin:"0 5px",color:"#1471ea"}},"用例",-1)])]),_:1},8,["onClick","index"])]),_:2},1032,["index"]))),128))]),_:1},8,["default-active"])]),n("div",ne,[o(j,{case_id:a(C)},null,8,["case_id"])])]),o(O,{modelValue:a(r),"onUpdate:modelValue":e[6]||(e[6]=t=>z(r)?r.value=t:r=t),size:"30%",direction:"rtl","with-header":!1},{footer:l(()=>[n("div",ie,[o(m,{onClick:e[4]||(e[4]=t=>N(E.value)),type:"primary",plain:""},{default:l(()=>[...e[19]||(e[19]=[u("确定",-1)])]),_:1}),o(m,{onClick:e[5]||(e[5]=t=>z(r)?r.value=!1:r=!1),plain:""},{default:l(()=>[...e[20]||(e[20]=[u("取消",-1)])]),_:1})])]),default:l(()=>[e[21]||(e[21]=n("div",{class:"title"},"添加用例",-1)),o(H,{model:a(d),"label-width":"auto",rules:I,ref_key:"formDataRef",ref:E},{default:l(()=>[o(x,{label:"用例名称：",prop:"title"},{default:l(()=>[o(P,{modelValue:a(d).title,"onUpdate:modelValue":e[1]||(e[1]=t=>a(d).title=t),placeholder:"请输入用例名称",clearable:""},null,8,["modelValue"])]),_:1}),o(x,{label:"所属接口：",prop:"interface"},{default:l(()=>[o(G,{modelValue:a(d).interface,"onUpdate:modelValue":e[2]||(e[2]=t=>a(d).interface=t),placeholder:"请选择所属接口",disabled:""},{default:l(()=>[(s(!0),p(g,null,w(a(v).interfaces,t=>(s(),f(q,{key:t.id,label:t.name,value:t.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),o(x,{label:"创建人：",prop:"username"},{default:l(()=>[o(P,{modelValue:a(d).username,"onUpdate:modelValue":e[3]||(e[3]=t=>a(d).username=t),placeholder:"请输入创建人",disabled:""},null,8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["modelValue"])],64)}}},xe=Y(re,[["__scopeId","data-v-f2507bae"]]);export{xe as default};
