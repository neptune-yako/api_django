<?xml version='1.1' encoding='UTF-8'?>
<flow-definition plugin="workflow-job@2.40">
  <actions/>
  <description>单节点示例 Pipeline</description>
  <keepDependencies>false</keepDependencies>
  <properties/>
  <definition class="org.jenkinsci.plugins.workflow.cps.CpsFlowDefinition" plugin="workflow-cps@2.90">
    <script>pipeline {
    agent { label &#x27;test-node-single&#x27; }
    
    stages {
        stage(&#x27;准备环境&#x27;) {
            steps {
                echo &#x27;======================================&#x27;
                echo &#x27;准备测试环境&#x27;
                echo &#x27;======================================&#x27;
                echo &quot;执行节点: ${env.NODE_NAME}&quot;
                // 在这里添加环境准备命令
                // sh &#x27;pip install -r requirements.txt&#x27;
            }
        }
        
        stage(&#x27;执行测试&#x27;) {
            steps {
                echo &#x27;======================================&#x27;
                echo &#x27;开始执行测试用例&#x27;
                echo &#x27;======================================&#x27;
                // 在这里添加测试命令
                // sh &#x27;pytest tests/ --alluredir=allure-results -v&#x27;
                
                // 模拟测试执行
                sh &#x27;&#x27;&#x27;
                    echo &quot;Running tests...&quot;
                    sleep 2
                    echo &quot;Tests completed successfully!&quot;
                &#x27;&#x27;&#x27;
            }
        }
        
        stage(&#x27;生成报告&#x27;) {
            steps {
                echo &#x27;======================================&#x27;
                echo &#x27;生成测试报告&#x27;
                echo &#x27;======================================&#x27;
                // 在这里添加报告生成命令
                // allure includeProperties: false, jdk: &#x27;&#x27;, results: [[path: &#x27;allure-results&#x27;]]
            }
        }
    }
    
    post {
        always {
            echo &#x27;======================================&#x27;
            echo &#x27;Pipeline 执行完成&#x27;
            echo &#x27;======================================&#x27;
        }
        success {
            echo &#x27;✓ 测试成功&#x27;
        }
        failure {
            echo &#x27;✗ 测试失败&#x27;
        }
    }
}</script>
    <sandbox>true</sandbox>
  </definition>
  <triggers/>
  <disabled>false</disabled>
</flow-definition>