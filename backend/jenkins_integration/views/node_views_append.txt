    """浠?Jenkins 鏈嶅姟鍣ㄥ悓姝ユ墍鏈夎妭鐐瑰埌鏈湴鏁版嵁搴?""
    
    @extend_schema(
        tags=['Jenkins 鑺傜偣绠＄悊'],
        summary='浠?Jenkins 鍚屾鑺傜偣',
        description='''
        浠?Jenkins 鏈嶅姟鍣ㄨ幏鍙栨墍鏈夎妭鐐瑰苟鍚屾鍒版湰鍦版暟鎹簱銆?
        
        鍔熻兘璇存槑:
        - 浠?Jenkins 鏈嶅姟鍣ㄨ幏鍙栨墍鏈夎妭鐐逛俊鎭?
        - 鍒涘缓鎴栨洿鏂版湰鍦版暟鎹簱涓殑鑺傜偣璁板綍
        - 涓嶄細鍒犻櫎鏈湴宸叉湁鐨勮妭鐐硅褰?
        - 閫傜敤浜庨娆″悓姝ユ垨鎵嬪姩鍒锋柊鑺傜偣鍒楄〃
        ''',
        responses={
            200: {
                'description': '鍚屾鎴愬姛',
                'content': {
                    'application/json': {
                        'example': {
                            'code': 200,
                            'message': '鎴愬姛鍚屾 5 涓妭鐐?,
                            'data': {
                                'total': 5,
                                'created': 2,
                                'updated': 3
                            }
                        }
                    }
                }
            },
            500: {'description': '鏈嶅姟鍣ㄥ唴閮ㄩ敊璇?}
        }
    )
    def post(self, request):
        """
        浠?Jenkins 鍚屾鑺傜偣鍒版暟鎹簱
        
        Returns:
            {
                "code": 200,
                "message": "鎴愬姛鍚屾 5 涓妭鐐?,
                "data": {
                    "total": 5,
                    "created": 2,
                    "updated": 3
                }
            }
        """
        try:
            from ..models import JenkinsNode, JenkinsServer
            from ..jenkins_client import get_all_nodes
            
            logger.info("寮€濮嬩粠 Jenkins 鏈嶅姟鍣ㄥ悓姝ヨ妭鐐?)
            
            # 鑾峰彇娲昏穬鐨?Jenkins 鏈嶅姟鍣?
            server = JenkinsServer.objects.filter(is_active=True).first()
            
            if not server:
                return R.bad_request(message='鏈壘鍒版椿璺冪殑 Jenkins 鏈嶅姟鍣ㄩ厤缃?)
            
            # 浠?Jenkins 鑾峰彇鎵€鏈夎妭鐐?
            success, message, nodes_data = get_all_nodes()
            
            if not success:
                return R.jenkins_error(message=f'浠?Jenkins 鑾峰彇鑺傜偣澶辫触: {message}')
            
            if not nodes_data:
                return R.success(message='Jenkins 涓婃病鏈夎妭鐐?, data={'total': 0, 'created': 0, 'updated': 0})
            
            # 鍚屾鍒版暟鎹簱
            created_count = 0
            updated_count = 0
            
            for node_data in nodes_data:
                node_name = node_data.get('name')
                
                if not node_name:
                    continue
                
                # 浣跨敤 update_or_create 鍒涘缓鎴栨洿鏂拌妭鐐?
                node, created = JenkinsNode.objects.update_or_create(
                    server=server,
                    name=node_name,
                    defaults={
                        'display_name': node_data.get('displayName', node_name),
                        'description': node_data.get('description', ''),
                        'num_executors': node_data.get('numExecutors', 1),
                        'labels': node_data.get('labels', ''),
                        'ip_address': node_data.get('ip_address', ''),
                        'is_online': not node_data.get('offline', False),
                        'is_idle': node_data.get('idle', True),
                        'offline_cause': node_data.get('offlineCauseReason', ''),
                    }
                )
                
                if created:
                    created_count += 1
                    logger.info(f"鉁?鍒涘缓鑺傜偣: {node_name}")
                else:
                    updated_count += 1
                    logger.info(f"鉁?鏇存柊鑺傜偣: {node_name}")
            
            total_count = created_count + updated_count
            result_message = f'鎴愬姛鍚屾 {total_count} 涓妭鐐?(鏂板 {created_count}, 鏇存柊 {updated_count})'
            
            logger.info(result_message)
            
            return R.success(
                message=result_message,
                data={
                    'total': total_count,
                    'created': created_count,
                    'updated': updated_count
                }
            )
            
        except Exception as e:
            error_msg = f"鍚屾鑺傜偣澶辫触: {str(e)}"
            error_trace = traceback.format_exc()
            logger.error(f"{error_msg}\\n{error_trace}")
            return R.internal_error(
                message=error_msg,
                data={'traceback': error_trace}
            )
